# 多线程详解

### 线程简介

进程（Process）：进程是程序执行的一次过程，是一个**动态**的概念。是系统资源分配的基本单位，

线程（Thread）：一个进程中可以包含若干个进程。线程是CPU运算调度的基本单位。

多线程：很多多线程是模拟出来的，真正的多线程是指有多个cpu（多核，如服务器）。模拟出来的多线程是在一个cpu的情况下，在同一时间点，cpu只能执行一个代码，只是切换的很快有同时执行的错觉。



多线程和普通方法的区别：

普通方法：只有主线程一条执行路径；

多线程：多条执行路径，主线程和子线程**并行交替**执行；



核心概念：

* 线程是独立的执行路径；
* 在程序运行时，即使没有自己创造线程，后台也会有多个线程，如主线程，gc线程；

* main()称为主线程，为系统的入口，用于执行整个程序；
* 在进程中，如果开辟了很多个线程，线程的运行由调度器安排调度，调度器是与操作系统紧密相关的，不能人为干预；
* 对同一份资源操作时，会存在资源抢夺问题，需要加入并发控制；
* 线程会带来额外的开销，如cpu调度时间，并发控制开销；
* 每个线程只能在自己的工作内存交互，内存控制不当会导致数据不一致



### 线程创建

三种方式：

（1）继承Thread类【声明为Thread的子类，并重写run类】（重点）

（2）实现Runnable接口【重写run类的T】（重点）

（3）实现Callable接口（了解）



**方式一、继承Thread类**

过程：

* 自定义线程继承Thread类；
* 重写run方法，编写线程执行体；
* 创建线程对象，调用start()方法启动线程。（注意：调用start方法会自动调用重写的run方法）



demo:

```java
public class TestThread1 extends Thread{
    @Override
    public void run() {
        //run方法线程体
        for (int i = 0; i < 20; i++) {
            System.out.println("Thread线程"+i);
        }
    }

    public static void main(String[] args) {
        //主线程
        TestThread1 testThread1 = new TestThread1();//创建线程对象
        testThread1.start();//调用start方法开启线程

        for (int i = 0; i < 1000; i++) {
            System.out.println("主线程"+i);
        }

    }
}
```



总结：

* 线程开启不一定立即执行，由CPU调度执行；
* 多线程和主线程并行交替执行；



**方式二、实现Runnable接口**

过程：

* 自定义线程实现Runnable接口；
* 重写run方法，编写线程执行体；
* 创建线程对象，在创建`Thread`时作为参数传递，调用start()方法启动线程。（注意：调用start方法会自动调用重写的run方法）





